<?xml version="1.0" encoding="utf-8" ?>
	<SearchRouteInfo>
		<MainSQL>
			WITH TT_EQPT_SMPL AS
			(
			SELECT DISTINCT
			EQGRID
			, EA.S71
			, P.PROCID --DISTINCT PE.EQPTID
			FROM PROCESSEQUIPMENT           PE   
			INNER JOIN EQUIPMENT            E    ON E.EQPTID = PE.EQPTID
			INNER JOIN EQUIPMENTATTR		EA   ON EA.EQPTID = E.EQPTID
			INNER JOIN EquipmentSegment		ES   ON ES.EQSGID = E.EQSGID
			INNER JOIN EquipmentSegmentAttr ESA  ON ESA.EQSGID = E.EQSGID
			INNER JOIN Process              P    ON P.PROCID = PE.PROCID
			WHERE 1=1
			AND ES.AREAID = @AREA_ID
			AND ESA.S38 = @SYSTEM_TYPE_CODE
			AND PE.USE_FLAG = 'Y'
			)
			SELECT
			T1.EQGRID AS EQPTID
			, R.ROUTID AS ROUT
			, RP.PROCID AS 공정
			, RP.LANE_ID
			, '' AS EQGRID
			, '' AS 극성
			, '' AS LOTTYPE
			, RP.PROC_SEQNO AS 순서
			FROM TB_MMD_FORM_ROUT            R    
			INNER JOIN TB_MMD_FORM_ROUT_PROC RP   ON R.ROUTID = RP.ROUTID
			INNER JOIN TT_EQPT_SMPL          T1   ON T1.S71 = RP.LANE_ID  AND T1.PROCID = RP.PROCID
			WHERE R.ROUTID = @ROUT
			AND RP.USE_FLAG = 'Y'
			UNION
			SELECT
			E.EQPTID
			, PD.PRODID AS ROUT
			, P.PROCID AS 공정
			, LT.DEMAND_TYPE AS LANE_ID
			, E.EQGRID
			, PDA.S13 AS 극성
			, LT.LOTTYPE
			, 0 AS 순서
			FROM PROCESSEQUIPMENT               PE  
			INNER JOIN EQUIPMENT            E     ON E.EQPTID = PE.EQPTID
			INNER JOIN EQUIPMENTATTR		EA    ON EA.EQPTID = E.EQPTID
			INNER JOIN EquipmentSegment		ES    ON ES.EQSGID = E.EQSGID AND ES.AREAID = @AREA_ID
			INNER JOIN EquipmentSegmentAttr ESA   ON ESA.EQSGID = E.EQSGID AND ESA.S38 = @SYSTEM_TYPE_CODE
			INNER JOIN Process              P     ON P.PROCID = PE.PROCID
			INNER JOIN EIOATTR              EioA  ON EioA.EQPTID = E.EQPTID
			INNER JOIN TB_SFC_WO_MTRL       TSWM  ON EioA.WO_DETL_ID = TSWM.WOID AND TSWM.USE_FLAG = 'Y' --AND TSWM.UNIT_CODE = 'EA'
			INNER JOIN Product				PD    ON PD.PRODID = TSWM.MTRLID AND PD.PRODIUSE = 'Y'
			INNER JOIN ProductAttr			PDA   ON PDA.PRODID = TSWM.MTRLID
			INNER JOIN TB_SFC_FP_DETL_PLAN  TSFDP ON TSWM.WOID = TSFDP.WO_DETL_ID
			INNER JOIN LotType              LT    ON LT.DEMAND_TYPE = TSFDP.DEMAND_TYPE
			WHERE 1=1
			AND PE.USE_FLAG = 'Y'
			AND EQGRID IN ('PKG','LAM','NND','ROL','COT')
			Order by 순서, EQPTID
		</MainSQL>
		<Option>
			<Option1 type="VAR" condition="" key="SYSTEM_TYPE_CODE" dataType="string" default=""/>
			<Option2 type="VAR" condition="" key="AREA_ID" dataType="string" default=""/>
			<Option3 type="VAR" condition="" key="ROUT" dataType="string" default=""/>
		</Option>
		<AdditionalVariable/>
		<Coloring>
			<ROUT Red="255" Green="155" Blue="155" IsColoringColumn="true" IsTimeCompare="false"/>
			<LANE_ID Red="255" Green="155" Blue="155" IsColoringColumn="false" IsTimeCompare="false">
				<AEUPPER Red="246" Green="247" Blue="196" IsColoringRow="false"/>
				<AELOWER Red="246" Green="214" Blue="214" IsColoringRow="false"/>
			</LANE_ID>
		</Coloring>
		<EventValues/>
	</SearchRouteInfo>