<?xml version="1.0" encoding="utf-8" ?>
	<SearchRouteInfo>
		<MainSQL>
WITH TT_EQPT_SMPL AS
         (SELECT DISTINCT E.FACTORY_AREA_ID
                        , E.LANE_ID
                        , P.PROCESS_CODE --DISTINCT PE.EQPTID
          FROM TB_EGN_PRCS_EQP_MAP PE
                   INNER JOIN TB_EGN_EQUIP_SPEC_MST E
                       ON E.REPRESENTATIVE_FACTORY_CODE = PE.REPRESENTATIVE_FACTORY_CODE
                           AND E.EQUIPMENT_ID = PE.EQUIPMENT_ID
                   INNER JOIN TB_EGN_FCTRY_AREA_MST ES
                       ON ES.REPRESENTATIVE_FACTORY_CODE = PE.REPRESENTATIVE_FACTORY_CODE
                           AND ES.FACTORY_AREA_ID = E.FACTORY_AREA_ID
                   INNER JOIN TB_EGN_PRCS_MST P
                       ON P.FACILITY_CODE = PE.REPRESENTATIVE_FACTORY_CODE
                           AND P.PROCESS_CODE = PE.PROCESS_CODE
          WHERE 1 = 1
            --AND ES.FACTORY_AREA_ID = @FACTORY_AREA_ID
            AND PE.REPRESENTATIVE_FACTORY_CODE = @REP_FACTORY_CODE
            AND PE.USE_FLAG = 'Y')
SELECT T1.FACTORY_AREA_ID AS EQPTID
     , R.ROUTE_ID         AS ROUTE_ID
     , RP.PROCESS_CODE    AS 공정
     , RP.LANE_ID
     , ''                 AS EQGRID
     , ''                 AS 극성
     , ''                 AS LOTTYPE
     , RP.PROC_SEQNO      AS 순서
FROM TB_EGN_RT_MST R
         INNER JOIN TB_EGN_RT_PRCS_MAP RP
             ON R.ROUTE_ID = RP.ROUTE_ID
         INNER JOIN TT_EQPT_SMPL T1
             ON T1.LANE_ID = RP.LANE_ID
                    AND T1.PROCESS_CODE = RP.PROCESS_CODE
WHERE R.ROUTE_ID = @ROUTE_ID
  AND RP.USE_FLAG = 'Y'
-- UNION
-- SELECT E.EQPTID
--      , PD.PRODID      AS ROUTE_ID
--      , P.PROCID       AS 공정
--      , LT.DEMAND_TYPE AS LANE_ID
--      , E.EQGRID
--      , PDA.S13        AS 극성
--      , LT.LOTTYPE
--      , 0              AS 순서
-- FROM PROCESSEQUIPMENT PE
--          INNER JOIN EQUIPMENT E ON E.EQPTID = PE.EQPTID
--          INNER JOIN EQUIPMENTATTR EA ON EA.EQPTID = E.EQPTID
--          INNER JOIN EquipmentSegment ES ON ES.EQSGID = E.EQSGID AND ES.AREAID = @FACTORY_AREA_ID
--          INNER JOIN EquipmentSegmentAttr ESA ON ESA.EQSGID = E.EQSGID AND ESA.S38 = @REP_FACTORY_CODE
--          INNER JOIN Process P ON P.PROCID = PE.PROCID
--          INNER JOIN EIOATTR EioA ON EioA.EQPTID = E.EQPTID
--          INNER JOIN TB_SFC_WO_MTRL TSWM
--                     ON EioA.WO_DETL_ID = TSWM.WOID AND TSWM.USE_FLAG = 'Y' --AND TSWM.UNIT_CODE = 'EA'
--          INNER JOIN Product PD ON PD.PRODID = TSWM.MTRLID AND PD.PRODIUSE = 'Y'
--          INNER JOIN ProductAttr PDA ON PDA.PRODID = TSWM.MTRLID
--          INNER JOIN TB_SFC_FP_DETL_PLAN TSFDP ON TSWM.WOID = TSFDP.WO_DETL_ID
--          INNER JOIN LotType LT ON LT.DEMAND_TYPE = TSFDP.DEMAND_TYPE
-- WHERE 1 = 1
--   AND PE.USE_FLAG = 'Y'
--   AND EQGRID IN ('PKG', 'LAM', 'NND', 'ROL', 'COT')
Order by RP.PROC_SEQNO , EQPTID
		</MainSQL>
		<Option>
			<Option1 type="VAR" condition="" key="FACTORY_AREA_ID" dataType="string" default=""/>
			<Option2 type="VAR" condition="" key="REP_FACTORY_CODE" dataType="string" default=""/>
			<Option3 type="VAR" condition="" key="ROUTE_ID" dataType="string" default=""/>
		</Option>
		<AdditionalVariable/>
		<Coloring>
			<ROUTE_ID Red="255" Green="155" Blue="155" IsColoringColumn="true" IsTimeCompare="false"/>
			<LANE_ID Red="255" Green="155" Blue="155" IsColoringColumn="false" IsTimeCompare="false">
				<AEUPPER Red="246" Green="247" Blue="196" IsColoringRow="false"/>
				<AELOWER Red="246" Green="214" Blue="214" IsColoringRow="false"/>
			</LANE_ID>
		</Coloring>
		<EventValues/>
	</SearchRouteInfo>